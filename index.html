<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simulador PI - Inflado de neumáticos</title>

  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>Simulador PI: inflado de neumáticos</h1>
    <p>Interfaz interactiva — ajuste Kp/Ki, referencia y perturbaciones en tiempo real.</p>
  </header>

  <main>
    <section id="controls">
      <h2>Controles</h2>

      <div class="row">
        <label>Presión objetivo (PSI) - Setpoint
          <input id="setpoint" type="number" step="0.1" value="125">
        </label>

        <label>Kp - Ganancia Proporcional
          <input id="Kp" type="number" step="0.01" value="1">
        </label>

        <label>Ki - Ganancia Integral
          <input id="Ki" type="number" step="0.01" value="0.06">
        </label>
      </div>

      <div class="row">
        <label>Ruido σ (PSI)
          <input id="sigma" type="number" step="0.01" value="0.10" min="0">
        </label>

        <label>Tiempo total (s)
          <input id="tTotal" type="number" step="1" value="120" min="5">
        </label>

        <label>dt (s)
          <input id="dt" type="number" step="0.01" value="0.05" min="0.005">
        </label>
      </div>

      <div class="row">
        <label>Valor leak (PSI/s)
          <input id="leakValue" type="number" step="0.01" value="1.0" min="0">
        </label>

        <label>Duración leak (s)
        <input id="leakDuration" type="number" step="1" value="5" min="1">
        </label>


        <button id="applyLeak">Aplicar leak ahora</button>
        <button id="clearLeak">Quitar leak</button>

        <label>Presión inicial (PSI)
          <input id="P0" type="number" step="0.1" value="20">
        </label>
      </div>

      <div class="row">
        <label>Kplant - Ganancia del Proceso 
          <input id="Kplant" type="number" step="0.1" value="140" readonly>
        </label>

        <label>τ (tau) (s)
          <input id="tau" type="number" step="0.1" value="5" readonly>
        </label>

        <button id="startBtn">Iniciar</button>
        <button id="stopBtn">Detener</button>
        <button id="resetBtn">Reiniciar</button>
      </div>

      <div class="notes">
        <p><strong>Nota:</strong> Kplant y τ son parámetros fijos del modelo</p>
      </div>
    </section>

    <section id="status">
      <h2>Estado (números)</h2>
      <div id="statusValues">
        <div>t: <span id="st_t">0.0</span> s</div>
        <div>P: <span id="st_P">0.0</span> PSI</div>
        <div>f: <span id="st_f">0.0</span> PSI</div>
        <div>e: <span id="st_e">0.0</span> PSI</div>
        <div>u: <span id="st_u">0.0</span></div>
        <div>Leak activo: <span id="st_leak">0.0</span> PSI/s</div>
        <div>Presión objetivo (PSI) - Setpoint (θi): <span id="st_ref">0.0</span> PSI</div>
      </div>
    </section>


    <section id="charts">
      <h2>Gráficos</h2>

      <div class="chartRow">
        <div class="chartCard">
          <canvas id="chartP"></canvas>
          <div class="chartLabel">Presión P(t) — salida del sistema (θo)</div>
        </div>

        <div class="chartCard">
          <canvas id="chartE"></canvas>
          <div class="chartLabel">Error e[Kt] — entrada del controlador</div>
        </div>
      </div>

      <div class="chartRow">
        <div class="chartCard">
          <canvas id="chartU"></canvas>
          <div class="chartLabel">Señal de control u(t) — salida del controlador PI</div>
        </div>

        <div class="chartCard">
          <canvas id="chartLeak"></canvas>
          <div class="chartLabel">Perturbación leak(t)</div>
        </div>

        <div class="chartCard">
          <canvas id="chartF"></canvas>
          <div class="chartLabel">Lectura sensor f[Kt] — retroalimentación</div>
        </div>

        <div class="chartCard">
        <canvas id="chartRef"></canvas>
        <div class="chartLabel">Presión objetivo (PSI) - Setpoint (θi)</div>
        </div>

      </div>
    </section>

    
  </main>

  <footer>
    <small>Simulador PI - Inflado de neumáticos — interactividad para TFI</small>
  </footer>

  <script src="script.js"></script>
</body>
</html>
